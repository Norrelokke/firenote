var xe=Object.defineProperty,Ne=Object.defineProperties;var be=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var V=(t,s,n)=>s in t?xe(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,E=(t,s)=>{for(var n in s||(s={}))Se.call(s,n)&&V(t,n,s[n]);if(Y)for(var n of Y(s))Re.call(s,n)&&V(t,n,s[n]);return t},J=(t,s)=>Ne(t,be(s));import{i as Fe,g as Ie,a as Ue,B as Ce,r as o,o as ke,j as i,b as e,c as Le,d as Ae,s as Pe,e as De,N as Te,C as N,I as X,S as C,q as P,W as D,f as Z,u as $,F,h as K,L as M,k as Ee,l as ee,m as q,n as T,p as g,A as _,t as k,v as Q,w as z,x as B,E as te,y as W,z as se,D as H,G as Me,_ as qe,H as ne,J as _e,K as Qe,M as ae,O,P as ze,Q as Be,R as Oe,T as je,U as Ge,V as I,X as $e,Y as Ke,Z as We,$ as He,a0 as Ye,a1 as Ve}from"./vendor.fe248788.js";const Je=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))l(a);new MutationObserver(a=>{for(const d of a)if(d.type==="childList")for(const u of d.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const d={};return a.integrity&&(d.integrity=a.integrity),a.referrerpolicy&&(d.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?d.credentials="include":a.crossorigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(a){if(a.ep)return;a.ep=!0;const d=n(a);fetch(a.href,d)}};Je();const Xe={apiKey:"AIzaSyCNYDAxs-8T9B6_qIIf7Ox8A6gmmayq7kQ",authDomain:"firenote-25182.firebaseapp.com",projectId:"firenote-25182",storageBucket:"firenote-25182.appspot.com",messagingSenderId:"473871512660",appId:"1:473871512660:web:35225075fdc14847ad69c1"},re=Fe(Xe),j=Ie(),G=Ue(re),b=Ce(re),oe=o.exports.createContext(),w=()=>o.exports.useContext(oe),Ze=({children:t})=>{const[s,n]=o.exports.useState(null),[l,a]=o.exports.useState(!0),d=async(c,r)=>Ae(j,c,r),u=(c,r)=>Pe(j,c,r),p=(c,r)=>De(j);o.exports.useEffect(()=>{ke(j,c=>{n(c),a(!1)})},[]);const h={signup:d,signin:u,signout:p,onlineUser:s,loading:l};return i(oe.Provider,{value:h,children:[l&&e("div",{className:"d-flex justify-content-center vh-100 my-5 align-items-center",children:e(Le.HashLoader,{color:"#222",size:40})}),!l&&t]})},le=({children:t,redirectTo:s})=>{const{onlineUser:n}=w();return n?t:e(Te,{to:s})},ie=({query:t})=>e(N,{children:t.data===void 0||t.data.length==1?e(N,{className:"text-center",children:"This folder does not contain any images, go to settings to upload"}):e(X,{children:e("div",{className:"img-grid",children:t.data&&t.data.map(s=>e("div",{className:s.className?s.className:"img-wrap",children:e("img",{src:s.url,alt:"uploaded image"})},s._id))})})}),ce=(t={})=>{const{onlineUser:s}=w(),n=C(b,"images"),l=t.fetchUserImages?["images",s.uid]:["images"],a=t.fetchUserImages?P(n,Z("owner","==",s.uid),D("created","desc")):P(n,D("created","desc"));return $(l,a,{idField:"_id"})},et=()=>{const{onlineUser:t}=w(),s=ce();return i(F,{children:[e("div",{className:"text-center",children:t?e("p",{children:'Upload folders and images under "my profile" in menu '}):e("p",{children:"Sign up to upload images!"})}),e("div",{className:"text-center",children:e("h1",{children:"Latest from users"})}),e(ie,{query:s})]})},tt=()=>{const{onlineUser:t}=w();return e(K,{variant:"light",expand:"md",children:i(N,{children:[i(M,{to:"/",className:"navbar-brand",children:[e("span",{role:"img"})," FireNote"]}),e(K.Toggle,{"aria-controls":"basic-navbar-nav"}),e(K.Collapse,{id:"basic-navbar-nav",children:e(Ee,{className:"ms-auto",children:t?e(F,{children:i(ee,{title:t.email,id:"basic-nav-dropdown",children:[e(q,{to:"/myprofile",className:"nav-link",children:"My Profile"}),e(ee.Divider,{}),e(q,{to:"/logout",className:"nav-link",children:" Logout"})]})}):i(F,{children:[e(q,{to:"/loginPage",className:"nav-link",children:"Login"}),e(q,{to:"/login",className:"nav-link"})]})})})]})})},de=()=>{const t=o.exports.useRef(),s=o.exports.useRef(),n=T(),{signin:l}=w(),[a,d]=o.exports.useState(null),[u,p]=o.exports.useState(!0);return i(N,{className:"col-md-4 py-5",children:[e("h1",{className:"text-center",children:"Login"}),i(g,{onSubmit:async c=>{c.preventDefault(),d(null);try{p(!0),await l(t.current.value,s.current.value),n("/")}catch(r){d(r.message),p(!1)}},children:[a&&e(_,{variant:"danger",children:a}),i(g.Group,{id:"email",children:[e(g.Label,{children:"Email"}),e(g.Control,{type:"email",ref:t,placeholder:"Enter email",required:!0})]}),i(g.Group,{id:"Password",children:[e(g.Label,{children:"Password"}),e(g.Control,{type:"password",ref:s,placeholder:"Password",required:!0})]}),e(k,{className:"text-center",variant:"primary",type:"submit",children:"Sign In"})]}),i("div",{className:"text-center mt-3",children:["Need an account? ",e(M,{to:"/signup",children:"Sign Up"})]})]})},ue=()=>{const{signup:t}=w(),[s,n]=o.exports.useState(),l=o.exports.useRef(),a=o.exports.useRef(),d=o.exports.useRef(),[u,p]=o.exports.useState(null),h=T();return i(N,{className:"col-md-4 py-5",children:[e("h1",{className:"text-center",children:"Sign up"}),i(g,{onSubmit:async r=>{if(r.preventDefault(),a.current.value!==d.current.value)return p("The passwords does not match");p(null);try{n(!0),await t(l.current.value,a.current.value),h("/")}catch(x){p(x.message),n(!1)}},children:[u&&e(_,{variant:"danger",children:u}),i(g.Group,{id:"email",children:[e(g.Label,{children:"Email"}),e(g.Control,{ref:l,type:"email",placeholder:"Email",required:!0})]}),i(g.Group,{id:"password",children:[e(g.Label,{children:"Create a password"}),e(g.Control,{ref:a,type:"password",name:"password",placeholder:"Password",required:!0})]}),i(g.Group,{id:"password",children:[e(g.Label,{children:"Confirm password"}),e(g.Control,{ref:d,type:"password",placeholder:"Confirm Password",required:!0})]}),e(k,{disabled:s,className:"text-center",variant:"primary",type:"submit",children:"Submit"})]}),i("div",{className:"text-center mt-3",children:["Already a member? ",e(M,{to:"/login",children:"Log In"})]})]})},st=()=>{const{onlineUser:t}=w();return e(F,{children:t?e(de,{}):e(ue,{})})},nt=()=>{const{signout:t}=w(),s=T();return o.exports.useEffect(async()=>{await t(),s("/")},[]),e(N,{className:"col-md-4 py-5",children:e("div",{className:"text-center",children:e("p",{children:" You're being signed out"})})})},at=t=>{const[s,n]=o.exports.useState(0),[l,a]=o.exports.useState(null),[d,u]=o.exports.useState(null),{onlineUser:p}=w();return o.exports.useEffect(()=>{const h=Q(G,`${p.uid}/images/ ${t.name}`),c=C(b,"images");z(h,t).on("state_changed",r=>{n(Math.round(r.bytesTransferred/r.totalBytes*100))},r=>{a(r)},async()=>{const r=await B(h);u(r),await te(c,{created:W(),name:t.name,owner:p.uid,path:h.fullPath,size:t.size,type:t.type,url:r})})},[t]),{progress:s,url:d,message:l}},rt=({file:t,setFile:s})=>{const{progress:n,url:l}=at(t);return o.exports.useEffect(()=>{l&&s(null)},[l,s]),e(F,{children:n&&e("div",{className:n,style:{width:n},children:n})})},ot=()=>{const[t,s]=o.exports.useState(null),[n,l]=o.exports.useState(null),a=d=>{let u=d.target.files[0];u&&u.type.includes("image")?(s(u),l({type:"success",msg:"File uploaded"})):(s(null),l({type:"warning",msg:"File must be an image"}))};return e("div",{className:"UploadForm",children:i(g,{children:[n&&e(_,{variant:n.type,children:n.msg}),e("h2",{children:"Upload Image"}),i("label",{children:[e("input",{type:"file",onChange:a}),e("span",{children:"+"})]}),e("div",{className:"output",children:t&&e(rt,{file:t,setFile:s})})]})})},he=(t={})=>{const{onlineUser:s}=w(),n=t.fetchReviewFolders?C(b,"reviewalbums"):C(b,s.uid),l=t.fetchReviewFolders?["reviewalbums"]:[s.uid],a=P(n,D("created","desc"));return $(l,a,{idField:"_id"})},lt=({query:t})=>{const s=T(),{onlineUser:n}=w();return i(N,{children:[i("div",{className:"text-center",children:[" ",e("h1",{children:"Folders"})," "]}),e("div",{className:"folder-grid",children:t.data&&t.data.map(l=>e("div",{className:"folder-wrap",onClick:()=>s("/folders/"+l.folderName+"/"+n.uid),children:i("h2",{children:["  ",l.folderName," "]})},l._id))})]})},it=()=>{const t=ce({fetchUserImages:!0}),s=he();return he({fetchReviewFolders:!0}),e("div",{className:"myprofile",children:i(N,{className:"py-3",children:[e("h1",{children:"Profile"}),e(ot,{}),i("div",{className:"text-center",children:[e("h2",{children:" Upload Folder"}),e(M,{to:"/uploadfolder",children:e("span",{className:"plus",children:"+"})})]}),e(lt,{query:s}),e(ie,{query:t})]})})},ct=()=>{const[t,s]=o.exports.useState(0),[n,l]=o.exports.useState(null),{onlineUser:a}=w(),[d,u]=o.exports.useState(null);return{progress:t,UploadFolder:(h,c,r)=>{const x=se();c===void 0&&(c=[]),r===void 0&&(r=[]);const m=Q(G,"folders/"+x);z(m,h,c).on("state_changed",f=>{s(Math.round(f.bytesTransferred/f.totalBytes*100))},f=>{l(f)},async()=>{const f=await B(m);u(f);const S=H(b,a.uid,h.name);await Me(S,{created:W(),folderName:h.name,path:m.fullPath,owner:a.uid,url:f,_id:x,folderCover:c.name,folderImages:r})})},url:d,message:n}},dt=()=>{const{UploadFolder:t}=ct(),s=o.exports.useRef(),n=o.exports.useRef(),[l,a]=o.exports.useState(!1),[d,u]=o.exports.useState(null),[p,h]=o.exports.useState(null),[c,r]=o.exports.useState(),x=()=>{const S=s.current.value;return r(S),c},m=S=>{let A=S.target.files[0];A&&A.type.includes("image")?u(A):(u(null),h({type:"warning",msg:"File must be an image"}))};return e(N,{children:i(g,{onSubmit:async S=>{S.preventDefault(),await t({name:s.current.value},d),h({type:"success",msg:"Folder uploaded, go to folder to upload images"})},children:[e("h1",{children:"Create new Folder"}),i(g.Group,{id:"folder",className:"mb-3",children:[e(g.Label,{children:"Foldername:"}),e(g.Control,{type:"text",ref:s,onChange:x}),e(g.Label,{children:"Upload cover: "}),e("input",{type:"file",ref:n,onChange:m})]}),e(k,{disabled:l,type:"submit",children:e("h4",{children:"Create Folder"})}),p&&e(_,{variant:p.type,children:p.msg})]})})},ut=()=>{const{onlineUser:t}=w(),s=C(b,t.uid);return{updateTitle:async(l,a)=>{const d=await qe(s);let u=[];d.forEach(c=>{u.push(E({id:c.id,name:c.name},c.data()))});const p=u.find(c=>c.folderName===l),h=H(b,thisUserId.uid,p.id);console.log(p.id),ne(h,{folderName:a})}}},ht=()=>{const[t,s]=o.exports.useState(0),[n,l]=o.exports.useState(null),[a,d]=o.exports.useState(null),{onlineUser:u}=w();return{progress:t,url:a,message:n,uploadImage:(h,c)=>{if(!h||h==null)return;const r=Q(G,`${u.uid}/${c}/${h.name}`),x=H(b,u.uid,c);z(r,h).on("state_changed",m=>{s(Math.round(m.bytesTransferred/m.totalBytes*100))},m=>{l(m)},async()=>{const m=await B(r);d(m),await ne(x,{folderImages:_e({name:h.name,owner:u.uid,path:r.fullPath,size:h.size,type:h.type,url:m})})})}}},pt=t=>{const s=ht(),n=o.exports.useCallback(c=>{!c.length||c.forEach(r=>{s.uploadImage(r,t.albumname)})},[]),{getRootProps:l,getInputProps:a,acceptedFiles:d,isDragActive:u,isDragAccept:p,isDragReject:h}=Qe({accept:"image/gif, image/jpeg, image/png, image/webp",onDrop:n,maxFiles:3});return i("div",J(E({},l()),{id:"upload-image-dropzone-wrapper",className:`${p?"drag-accept":""} ${h?"drag-reject":""}`,children:[e("input",E({},a())),u?p?e("div",{className:"dropzone",children:e("p",{children:"Drop file here"})}):e("p",{children:"not accepted format"}):e("div",{className:"dropzone",children:e("p",{children:"Drop file here"})}),d.length>0&&e("div",{className:"accepted-files mt-2",children:e("ul",{className:"list-unstyled",children:d.map(c=>i("li",{children:[c.name," (",Math.round(c.size/1024)," kb)"]},c.name))})})]}))},mt=()=>{const[t,s]=o.exports.useState(null),{onlineUser:n}=w(),[l,a]=o.exports.useState(null);return{UploadReview:(u,p)=>{console.log(u.folderimages);const h=se();u.folderimages===void 0;const c=Q(G,"/revfolders/"+h);z(c,u).on("state_changed",r=>{},r=>{s(r)},async()=>{const r=await B(c);a(r);const x=C(b,n.uid);var m=new Date,f=m.getHours()+":"+m.getMinutes()+":"+m.getSeconds();await te(x,{created:W(),folderName:f,path:c.fullPath,url:r,folderId:h,folderImages:u.folderimages})})},url:l,message:t}},gt=({query:t})=>{const s=ae(),{UploadReview:n}=mt(),l=T(),[a,d]=o.exports.useState(!1),[u,p]=o.exports.useState(!1),[h,c]=o.exports.useState([]),[r,x]=o.exports.useState([]),[m,f]=o.exports.useState([]);o.exports.useEffect(()=>{s.foldername&&p(!0)},[]);const S=()=>{d(!a)},A=async()=>{await n({folderimages:r}),l("/")},me=v=>{const y=r.filter(R=>R.path==v.path),L=m.filter(R=>R.path==v.path);y.length||L.length||(v.className="likedstyle",r.push(v),c(r.length+m.length))},ge=v=>{const y=r.filter(R=>R.path==v.path),L=m.filter(R=>R.path==v.path);y.length||L.length||(v.className="dislikedstyle",m.push(v),c(r.length+m.length))},fe=v=>{const y=r.filter(U=>U.path!==v.path),L=m.filter(U=>U.path!==v.path);y.length&&(x(y),console.log("liked",y),console.log(h)),L.length&&console.log("disliked"),f(L);const R=r.filter(U=>U.path==v.path),ve=r.filter(U=>U.path==v.path),ye=r.indexOf(R),we=r.indexOf(ve);r.splice(ye,1),r.splice(we,1),v.className="neutralstyle",c(r.length+m.length)};return i(N,{children:[i(X,{children:[i("div",{className:"text-center",children:[" ",e("h1",{children:"Images"})]}),u&&e(k,{type:"submit",onClick:S,children:e("h2",{children:"Review Album"})}),e("div",{className:"img-grid",children:t.data&&t.data.map(v=>v.folderImages.map(y=>i("div",{className:y.className?y.className:"img-wrap",children:[y._id,i(F,{children:["  ",e("img",{src:y.url,alt:"uploaded image"}),a&&i("div",{className:"rewiew-btns",children:[e(O,{className:"like-btn",onClick:()=>{fe(y)},icon:ze}),e(O,{className:"like-btn",onClick:()=>{me(y)},icon:Be}),e(O,{className:"dislike-btn",onClick:()=>{ge(y)},icon:Oe})]})]})]},y._id)))})]}),a&&i(F,{children:[" ",i("h3",{children:[h<=0?"0":h," / ",t.data?t.data[0].folderImages.length:"0"," "]}),e(k,{type:"submit",onClick:()=>{A()},children:e("h2",{children:"Create Review Album"})})]})]})},ft=(t={})=>{const{onlineUser:s}=w(),[n,l]=o.exports.useState(s),a=C(b,t.folderid),d=t.fetchAlbumImages?[n,n]:["images"],u=t.fetchAlbumImages?P(a,Z("folderName","==",t.foldername),D("created","desc")):P(a,D("created","desc"));return $(d,u,{idField:"_id"})},pe=()=>{const t=ae(),[s,n]=o.exports.useState(!1),l=o.exports.useRef(),{updateTitle:a}=ut(t.foldername),[d,u]=o.exports.useState(t.foldername),[p,h]=o.exports.useState("/folders/"+t.foldername+"/"+t.userid),c=ft({fetchAlbumImages:!0,foldername:t.foldername,folderid:t.userid}),r=()=>{n(!s)},x=()=>{var f=document.getElementById("urlInput");f.select(),f.setSelectionRange(0,99999),navigator.clipboard.writeText(f.value)};return i(F,{children:[i(N,{className:"singleFolder",children:[i("h3",{children:[" Folder ",d]}),i("h2",{children:["  ",e(O,{icon:je,onClick:r})," "]})]}),s&&i(N,{className:"foldername col-md-4 py-5",children:[e("h2",{children:"Change foldername:"}),i(g,{onSubmit:async f=>{f.preventDefault(),a(t.foldername,l.current.value),t.foldername!==l.current.value&&u(l.current.value)},children:[e(g.Control,{type:"text",ref:l}),e(k,{type:"submit",children:e("h3",{children:"Submit"})})]}),e(pt,{albumname:t.foldername}),i("p",{children:["Share Folderurl:  ",e("input",{type:"text",value:p,id:"urlInput",readOnly:!0})," ",e(k,{onClick:x,children:"Copy text"})]})]}),e(gt,{query:c})]})};function vt(){return i(F,{children:[e(tt,{}),e("div",{className:"App",children:i(Ge,{children:[e(I,{path:"/",element:e(et,{})}),e(I,{path:"/loginpage",element:e(st,{})}),e(I,{path:"/login",element:e(de,{})}),e(I,{path:"/signup",element:e(ue,{})}),e(I,{path:"/logout",element:e(nt,{})}),e(I,{path:"/folders/:foldername/:userid",element:e(pe,{})}),e(I,{path:"/revfolders/:foldername/:userid",element:e(pe,{})}),e(I,{path:"/myprofile",element:e(le,{redirectTo:"/login",children:e(it,{})})}),e(I,{path:"/uploadfolder",element:e(le,{redirectTo:"/login",children:e(dt,{})})})]})})]})}const yt=new $e({defaultOptions:{queries:{refetchOnWindowFocus:!1,staleTime:1e3*60*2,cacheTime:1e3*60*60*4}}});Ke.render(e(We.StrictMode,{children:e(He,{client:yt,children:e(Ye,{children:e(Ze,{children:e(Ve,{children:e(vt,{})})})})})}),document.getElementById("root"));
